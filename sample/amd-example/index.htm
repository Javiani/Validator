<!DOCTYPE HTML>
<html>
	<head>

		<title>Validator 2.0</title>
		<meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="chrome=1">
		<style type="text/css">
			*{margin:0;padding:0;list-style:none}body{background:#ededed}h1{text-align:center;margin:20px 0}form{width:300px;margin:80px auto 20px;padding:40px;background:#fff}form p{padding:5px 0}form input{width:80%;padding:5px 0}form label{width:50px;display:inline-block}form button{padding:10px 20px;display:block;margin:10px auto}ul.error li{padding:10px;background:#FFB2B2;margin:5px 0}input.error{border:2px solid red}
		</style>
	</head>
	<body>

		<h1>Validator - Sample</h1>
		<form action="/" novalidate>
			<p><label>Name :</label> <input type="text" class="required" name="" value=""  /></p>
			<p><label>Age :</label> <input type="text" class="required number" name="" value=""  /></p>
			<p><label>Email :</label> <input type="email" class="required" name="" value=""  /></p>
			<p><label>File :</label> <input type="file" class="required" name="" value=""  /><em>Accepts :jpg,png,gif</em></p>
			<p><button type="submit">Enviar</button></p>
		</form>

		<script src="//cdnjs.cloudflare.com/ajax/libs/zepto/1.1.4/zepto.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.20/require.min.js"></script>
		<script src='../../validator.js' type='text/javascript'></script>

		<script type="text/javascript">

			require([
				'validator',
				'messages',
				'rules'
			], function(validator){
				var v, form = $('form'), input = form.find('input');

				v = validator.create({ holder :form });

				v.add( '.required' , { rules :{ required :true } });
				v.add( '.number' , { rules :{ number :true } });
				v.add( 'input[type=email]' , { rules :{ email :true } });
				v.add( 'input[type=file]' , { rules :{ accept :'jpg|png|gif' } });

				v.on('validator:error', function(err){

					//Clearing errors
					clear_errors();
					$.each( err.list, error);
					console.log(err);
				});

				//Validation triggers

				form.on('submit', function(){
					return v.validate();
				});

				input.on('blur', function(){

					var element = v.test(this);

					if(!element.is_valid){
						error.call( element );
					}
					else{
						clear_errors( $(this).parent() );
					}
				});

				function clear_errors(holder){
					(holder || form).find('.error').removeClass('error');
				}

				function error(){

					$(this.element)
						.addClass('error')
						.prop('placeholder', this.messages.list[0]);
				}
			});

		</script>

	</body>
</html>
